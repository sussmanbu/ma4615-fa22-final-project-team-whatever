---
title: Analysis
description: 
toc: true
featuredVideo:
featuredImage: 
draft: false
---

We describe here our detailed data analysis.


```{r}
library(tidyverse)
library(ggplot2)
print(getwd())
load(here::here("dataset/income_mortality.RData"))
load(here::here("dataset/nd_regions.RData"))
load(here::here("dataset/nd_inc_mort_avg.RData"))
print(ls())
```

## Note on Attribution

If you are directly quoting from a source, please make that clear. You can show quotes using `>` like this




```
> To be or not to be.
```

> To be or not to be.

Also, make sure to provide a link or citation to where you are quoting from.

-------

## Motivation for Our Data Analysis

Our data is mainly driven by investigating 




## Initial Questions for Data Analysis



## Modeling and Inference

```{r}
ggplot(nd_regions, aes(Country , LowBirthWT,  fill=Country)) + 
    coord_flip() +
    geom_bar(stat="identity", width=.90) + 
    xlab("Region") + 
    ylab("Low Birth Weight Percentage") + 
    guides(fill=FALSE) +
    ggtitle("Percentage of Children Underweight in World Regions") + 
    theme_minimal()
```
```{r}

load(here::here("income_mortality.RData"))

#maybe need to include different regions and color them with "color = " under ggplot aes (instead of Income)

income_mortality %>% filter(Year == "1950" | Year == "1975" | Year == "2000" | Year == "2020") %>% ggplot(aes(x = Income, y = Mortality, color = Income)) + geom_point(size = 0.3) +
  facet_wrap(~as.factor(Year)) +
  stat_smooth(aes(group = Year), color='black', alpha = 0.4, geom = "line") +
  scale_x_log10() +
  labs(x = "Income Per Capita (PPP)", y = "Under 5 Mortality Rate", title = "Disparity across Under 5 Mortality Rates has decreased over time")
```

```{r}
load(here::here("dataset/nd_inc_mort_avg.RData"))
ggplot(nd_inc_mort_avg, aes(x = Income_avg, y = ExclusiveBreastFeeding)) + geom_point(size = 0.4) +
  stat_smooth(color='black', alpha = 0.2) +
  scale_x_log10() +
  labs(x = "Average Income Per Capita (PPP)", y = "Exclusive Breast Feeding Rate", title = "As income increases, exclusive breast feeding for children's nutrition decreases")
```
```{r}
load(here::here("dataset/nd_inc_mort_avg.RData"))
ggplot(nd_inc_mort_avg, aes(x = Income_avg, y = DietDiversity)) + geom_point(size = 0.4) +
  stat_smooth(color='black', alpha = 0.2) +
  scale_x_log10() +
  labs(x = "Average Income Per Capita (PPP)", y = "Diet Diversity", title = "As income increases, diet diversity for children's nutrition increases")
```
```{r}
library(maps)
library(ggplot2)
library(RColorBrewer)
library(tidyverse)

world_map <- map_data("world")

ggplot(world_map, aes(x = long, y = lat, group = group)) +
  geom_polygon(fill="white", colour = "gray50") +
  theme_classic()
```

```{r}
world_map %>%
  left_join(income_mortality, by = c("region" = "Country")) -> act_world_map
```


```{r}
act_world_map1970 <- act_world_map %>% filter(Year == c("1970"))
```

```{r}
ggplot(act_world_map1970,aes(x = long, y = lat, group = group))+
  geom_polygon(aes(fill = Mortality),color = "white")+
  scale_x_continuous(breaks = seq(-180,210,45),labels = function(x){paste0(x,"°")})+
  scale_y_continuous(breaks = seq(-60, 100, 30), labels = function(x){paste0(x, "°")})+
  scale_fill_gradient(low = "lightblue", high="dark blue") +
  theme_light()
```

```{r}
act_world_map1990 <- act_world_map %>% filter(Year == c("1990"))
```

```{r}
ggplot(act_world_map1990,aes(x = long, y = lat, group = group))+
  geom_polygon(aes(fill = Mortality),color = "white")+
  scale_x_continuous(breaks = seq(-180,210,45),labels = function(x){paste0(x,"°")})+
  scale_y_continuous(breaks = seq(-60, 100, 30), labels = function(x){paste0(x, "°")})+
  scale_fill_gradient(low = "lightblue", high="dark blue") +
  theme_light()
```

```{r}
act_world_map2000 <- act_world_map %>% filter(Year == c("2000"))
```

```{r}
ggplot(act_world_map2000,aes(x = long, y = lat, group = group))+
  geom_polygon(aes(fill = Mortality),color = "white")+
  scale_x_continuous(breaks = seq(-180,210,45),labels = function(x){paste0(x,"°")})+
  scale_y_continuous(breaks = seq(-60, 100, 30), labels = function(x){paste0(x, "°")})+
  scale_fill_gradient(low = "lightblue", high="dark blue") +
  theme_light()
```









## Clarity Figures

  
  
*explain your plots here  

```{r}
# Interesting structure for visualizing mortality rates by world regions when we'll have the world regions variable in the income_mortality data set

 #ggplot(nd_regions, aes(x=Country, y=LowBirthWT, color=Country)) +
     #geom_point(position="jitter") +
     #coord_polar("x") +
     #labs(title="% of Low Birth Weights by World Region", x="", y="", color ="Country" )
```





